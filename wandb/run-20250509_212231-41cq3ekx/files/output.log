Traceback (most recent call last):
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 215, in _broadcast_shapes_uncached
    return _try_broadcast_shapes(*rank_promoted_shapes, name='broadcast_shapes')
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 132, in _try_broadcast_shapes
    raise TypeError(f'{name} got incompatible shapes for broadcasting: '
TypeError: broadcast_shapes got incompatible shapes for broadcasting: (4, 1, 1, 1), (0, 128, 128, 3), (4, 128, 128, 3).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 193, in broadcast_shapes
    return _broadcast_shapes_cached(*shapes)
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/util.py", line 302, in wrapper
    return cached(config.trace_context() if trace_context_in_key else _ignore(),
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/util.py", line 296, in cached
    return f(*args, **kwargs)
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 199, in _broadcast_shapes_cached
    return _broadcast_shapes_uncached(*shapes)
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 218, in _broadcast_shapes_uncached
    raise ValueError(f"Incompatible shapes for broadcasting: shapes={list(shapes)}") from err
ValueError: Incompatible shapes for broadcasting: shapes=[(4, 1, 1, 1), (0, 128, 128, 3), (4, 128, 128, 3)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 215, in _broadcast_shapes_uncached
    return _try_broadcast_shapes(*rank_promoted_shapes, name='broadcast_shapes')
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 132, in _try_broadcast_shapes
    raise TypeError(f'{name} got incompatible shapes for broadcasting: '
TypeError: broadcast_shapes got incompatible shapes for broadcasting: (4, 1, 1, 1), (0, 128, 128, 3), (4, 128, 128, 3).

The above exception was the direct cause of the following exception:

jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/gpuadmin/UM_CISC7404_Reinforcement_gym_game/parallel-sac.py", line 547, in <module>
    trained_state = train(train_state, config, env_reset, env_step, env_params, buffer)
  File "/home/gpuadmin/UM_CISC7404_Reinforcement_gym_game/parallel-sac.py", line 391, in train
    obs = jnp.where(dones[:, None, None, None], reset_obs, next_obs)
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/numpy/lax_numpy.py", line 2859, in where
    return util._where(condition, x, y)
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/numpy/util.py", line 298, in _where
    condition, x_arr, y_arr = _broadcast_arrays(condition, x, y)
  File "/home/gpuadmin/miniconda3/envs/jax_rl/lib/python3.10/site-packages/jax/_src/numpy/util.py", line 252, in _broadcast_arrays
    result_shape = lax.broadcast_shapes(*shapes)
ValueError: Incompatible shapes for broadcasting: shapes=[(4, 1, 1, 1), (0, 128, 128, 3), (4, 128, 128, 3)]
